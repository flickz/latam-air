var tamGA=(function(){var newArVals={};var ffPattern=/ff-(\w+)/;var flightPattern=/flightId-(\d+)/;var getFF=function(attrClass){if(typeof attrClass!=="undefined"){var res=attrClass.match(ffPattern);if(typeof res[1]!=="undefined"){return res[1];}}return null;};var getFlightId=function(td){if(td.length>0){return td.parent().attr("class").match(flightPattern)[1];}return null;};var addNewArValIfNotNull=function(key,val){if(val!=null&&typeof val!=="undefined"&&val!=""){newArVals[key]=val;}};var addToForm=function(form){for(var key in newArVals){form.find("input[name="+key+"]").remove();var newInput=$("<input type='hidden' name='"+key+"' value='"+newArVals[key]+"' />");newInput.appendTo(form);}};return{getPageCode:function(){if(typeof ArVal!=="undefined"&&ArVal[76]!=="undefined"){return ArVal[76];}return"";},getOnSearch:function(){ArVal["75"]="SEARCH";},getOnUpsl:function(){var getPriceFromEl=function(el){if(typeof clientSideData.OD_UPSL_MATRIX!=="undefined"){var outKey;var inKey;var bound;var amount;if(clientSideData.SO_SITE_FD_DISPLAY_MODE=="0"){amount="AMOUNT";}else{amount="AMOUNT_WITHOUT_TAX";}if(el.closest("table.bound").hasClass("outbound")){outKey=getFF(el.attr("class"))+"_"+getFlightId(el);inKey=getFF($("table.bound.inbound td.selectedFF").eq(0).attr("class"))+"_"+getFlightId($("table.bound.inbound td.selectedFF").eq(0));bound=0;}else{inKey=getFF(el.attr("class"))+"_"+getFlightId(el);outKey=getFF($("table.bound.outbound td.selectedFF").eq(0).attr("class"))+"_"+getFlightId($("table.bound.outbound td.selectedFF").eq(0));bound=1;}if(typeof clientSideData.OD_UPSL_MATRIX[outKey]!=="undefined"&&typeof clientSideData.OD_UPSL_MATRIX[outKey][inKey]!=="undefined"){var priceFromEl=clientSideData.OD_UPSL_MATRIX[outKey][inKey].LIST_TRAVELLER_TYPE[0].LIST_TRAVELLER_PRICE[0].LIST_BOUND_PRICE[bound][amount]*clientSideData.EXCHANGE_RATE;if(priceFromEl!=null&&!isNaN(priceFromEl)){return parseFloat(priceFromEl).toFixed(2);}else{return null;}}else{return null;}}var localAmount=theUtils.getLocalIndependetAmount(el.data("cellPriceInReportingCurrency"));if(localAmount!=null&&!isNaN(localAmount)){return parseFloat(localAmount).toFixed(2);}else{return"";}};var lowestPriceFFcodeForOutbound=getFF($("table.bound.outbound td.lowest").eq(0).attr("class"));var lowestPriceFFcodeForInbound=getFF($("table.bound.inbound td.lowest").eq(0).attr("class"));addNewArValIfNotNull("ARVAL_83",lowestPriceFFcodeForOutbound);addNewArValIfNotNull("ARVAL_84",lowestPriceFFcodeForInbound);if(typeof lowestPriceFFcodeForOutbound!=="undefined"){addNewArValIfNotNull("ARVAL_87",jQuery.trim($("table.outbound thead td.f_"+lowestPriceFFcodeForOutbound).eq(0).data("ffName")));}if(typeof lowestPriceFFcodeForInbound!=="undefined"){addNewArValIfNotNull("ARVAL_88",jQuery.trim($("table.inbound thead td.f_"+lowestPriceFFcodeForInbound).eq(0).data("ffName")));}addNewArValIfNotNull("ARVAL_96",getPriceFromEl($("table.bound.outbound td.lowest")));addNewArValIfNotNull("ARVAL_97",getPriceFromEl($("table.bound.inbound td.lowest")));var outboundPriceBeforeTeaser;var inboundPriceBeforeTeaser;var setOnNewClick=function(arVal,el){addNewArValIfNotNull(arVal,getPriceFromEl(el));addToForm($("#ALPI_FORM"));};var updateValsBeforeTeaser=function(){outboundPriceBeforeTeaser=getPriceFromEl($("table.bound.outbound td.selectedFF").eq(0));inboundPriceBeforeTeaser=getPriceFromEl($("table.bound.inbound td.selectedFF").eq(0));};$("#rpTeaser, table.bound tbody").on("click","#rpUpgrade, tr.teaserInfo button",updateValsBeforeTeaser);$(document).on("click","table.bound.outbound td.selectedFF:not(.disabled)",function(){setOnNewClick("ARVAL_104",$(this));});$(document).on("click","table.bound.inbound td.selectedFF:not(.disabled)",function(){setOnNewClick("ARVAL_105",$(this));});$(document).on("click","#rpUpgrade, tr.teaserInfo button",function(){if($(this).attr("id")!="rpUpgrade"){$("table.bound tbody").on("click","tr.teaserInfo button",updateValsBeforeTeaser);}var newOutboundPriceBeforeTeaser=getPriceFromEl($("table.bound.outbound td.selectedFF").eq(0));var newInboundPriceBeforeTeaser=getPriceFromEl($("table.bound.inbound td.selectedFF").eq(0));if(newOutboundPriceBeforeTeaser!=outboundPriceBeforeTeaser||inboundPriceBeforeTeaser!=newInboundPriceBeforeTeaser){addNewArValIfNotNull("ARVAL_98",outboundPriceBeforeTeaser);addNewArValIfNotNull("ARVAL_99",inboundPriceBeforeTeaser);addNewArValIfNotNull("ARVAL_100",newOutboundPriceBeforeTeaser);addNewArValIfNotNull("ARVAL_101",newInboundPriceBeforeTeaser);}addToForm($("#ALPI_FORM"));});$("section.calendarPricesSection").on("click","ul",function(){var newCalendarPrice=jQuery.trim($(this).find("strong").text());addNewArValIfNotNull("ARVAL_102",newCalendarPrice);addNewArValIfNotNull("ARVAL_103",newCalendarPrice);addToForm($("#ALPI_FORM"));});addToForm($("#ALPI_FORM"));},setArValsInStorage:function(){if(typeof ArVal!=="undefined"){$.jStorage.set("AR_VAL",ArVal);}},getArValsFromStorage:function(){if(typeof ArVal!=="undefined"&&$.jStorage.get("AR_VAL")!=null){var arVals=$.jStorage.get("AR_VAL");ArVal=$.extend(true,arVals,ArVal);$.jStorage.deleteKey("AR_VAL");}}};})();function init(){if(typeof ArVal!=="undefined"&&ArVal!=null){switch(tamGA.getPageCode()){case"SEARCH":case"GENERR":tamGA.getOnSearch();break;case"UPSL":case"RD_UPSL":case"ATC_UPSL":setTimeout(function(){if(document.readyState=="complete"){tamGA.getOnUpsl();}},1);break;case"PURF":case"ATCPURF":if(document.readyState=="complete"){tamGA.setArValsInStorage();}break;case"ATCSEARCH":if(typeof ArVal[173]!=="undefined"&&ArVal[173]==="true"){_gaq.push(["tracker0._trackEvent","ATC Waiver","ATC Search","Contact the call center message is displayed"]);}break;case"BKGD":if(document.readyState=="complete"){tamGA.getArValsFromStorage();}break;case"ATCCONF":if(typeof ArVal[172]!=="undefined"&&ArVal[172]==="true"){_gaq.push(["tracker0._trackEvent","ATC Waiver","ATC Confirmation","Completed ATC waiver"]);}}}}init();window.onload=function(){(function(){var ga=document.createElement("script");ga.type="text/javascript";ga.async=true;if($.browser.msie&&($.browser.version=="10.0"||$.browser.version=="9.0")){var tamGAsrc=document.getElementById("scriptTamGA").src;var src=tamGAsrc.substring(0,tamGAsrc.lastIndexOf("desktop"));ga.src=src+"desktop/ga.js";}else{ga.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";}var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s);})();(function(){var hostCDN=clientSideData.WDS_GA_CDN_HTTP_DOMAIN;var hostCDNssl=clientSideData.WDS_GA_CDN_HTTPS_DOMAIN;var dirCDN="/fastTrack/WDS/JJ/";var gaeBA=document.createElement("script");gaeBA.type="text/javascript";gaeBA.src=("https:"==document.location.protocol?hostCDNssl:hostCDN)+dirCDN+clientSideData.WDS_GA_CDN_FILE_NAME;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(gaeBA,s);})();};