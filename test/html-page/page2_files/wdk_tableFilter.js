(function($){$.extend({tablefilter:new function(){var widgets=[];this.defaults={cssChildRow:"expand-child",textExtraction:"simple",widgets:[],widgetZebra:{css:["even","odd"]},constraintList:[]};function getElementText(config,node){var text="";if(!node){return"";}if(!config.supportsTextContent){config.supportsTextContent=node.textContent||false;}if(config.textExtraction=="simple"){if(config.supportsTextContent){text=node.textContent;}else{if(node.childNodes[0]&&node.childNodes[0].hasChildNodes()){text=node.childNodes[0].innerHTML;}else{text=node.innerHTML;}}}else{if(typeof(config.textExtraction)=="function"){text=config.textExtraction(node);}else{text=$(node).text();}}return text;}function applyWidget(table){var c=table.filterConfig.widgets;var l=c.length;for(var i=0;i<l;i++){getWidgetById(c[i]).format(table);}}function getWidgetById(name){var l=widgets.length;for(var i=0;i<l;i++){if(widgets[i].id.toLowerCase()==name.toLowerCase()){return widgets[i];}}}function filter(table,constraintList){var showTr=true;var nbDisplayedRows=0;var filterRowFunction=function(i){var tr=$(this);if(!tr.hasClass(table.filterConfig.cssChildRow)){showTr=true;for(i in constraintList){var constraint=constraintList[i];var cells=tr[0].cells;if(constraint.columnIndex!==undefined&&constraint.type!==undefined&&constraint.value!==undefined){if(constraint.columnIndex>=0&&constraint.columnIndex<cells.length&&(constraint.type=="eq"||constraint.type=="neq"||constraint.type=="gt"||constraint.type=="lt"||constraint.type=="gte"||constraint.type=="lte")){var cellValue=getElementText(table.filterConfig,cells[constraint.columnIndex]);if(typeof constraint.value=="number"){cellValue=parseFloat(cellValue);}if(constraint.type=="eq"&&cellValue!=constraint.value||constraint.type=="neq"&&cellValue==constraint.value||constraint.type=="gt"&&cellValue<=constraint.value||constraint.type=="lt"&&cellValue>=constraint.value||constraint.type=="gte"&&cellValue<constraint.value||constraint.type=="lte"&&cellValue>constraint.value){showTr=false;break;}}}}if(showTr){nbDisplayedRows++;}}tr.add(tr.children()).toggle(showTr);};$("tr",table.tBodies[0]).each(filterRowFunction);return nbDisplayedRows;}this.construct=function(settings){return this.each(function(){if(!this.tBodies){return;}var $this,filterConfig;this.filterConfig={};filterConfig=$.extend(this.filterConfig,$.tablefilter.defaults,settings);$this=$(this);$.data(this,"tablefilter",filterConfig);$this.bind("filter",function(e,constraintList){$(this).trigger("filteringStart");filterConfig.constraintList=constraintList;var nbDisplayedRows=filter(this,constraintList);applyWidget(this);$(this).trigger("filteringEnd",[nbDisplayedRows]);}).bind("applyWidgetId",function(e,id){getWidgetById(id).format(this);}).bind("applyWidgets",function(){applyWidget(this);});if($.metadata&&($(this).metadata()&&$(this).metadata().constraintList)){filterConfig.constraintList=$(this).metadata().constraintList;}if(filterConfig.constraintList.length>0){$this.trigger("filter",[filterConfig.constraintList]);}else{applyWidget(this);}});};this.addWidget=function(widget){widgets.push(widget);};}});$.fn.extend({tablefilter:$.tablefilter.construct});var ts=$.tablefilter;ts.addWidget({id:"zebra",format:function(table){var $tr,row=-1,odd;$("tr:visible",table.tBodies[0]).each(function(i){$tr=$(this);if(!$tr.hasClass(table.filterConfig.cssChildRow)){row++;}odd=(row%2===0);$tr.removeClass(table.filterConfig.widgetZebra.css[odd?0:1]).addClass(table.filterConfig.widgetZebra.css[odd?1:0]);});}});})(jQuery);